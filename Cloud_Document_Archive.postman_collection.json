{
  "info": {
    "_postman_id": "cloud-document-archive-api-v2",
    "name": "Cloud Document Archive API v2.0.0",
    "description": "Complete Postman collection for Cloud Document Archive API v2.0.0\n\nIncludes:\n- Authentication (JWT)\n- Document Operations (Archive, Retrieve, Delete, Search)\n- Deep Archive & Glacier Management\n- Lifecycle & Restore Management  \n- PII Detection & Anonymization\n- Audit Trail\n\nBase URL: http://localhost:8000\nDefault admin credentials: admin / password",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string",
      "description": "JWT access token (auto-filled after login)"
    },
    {
      "key": "refresh_token",
      "value": "",
      "type": "string",
      "description": "JWT refresh token (auto-filled after login)"
    },
    {
      "key": "username",
      "value": "admin",
      "type": "string"
    },
    {
      "key": "password",
      "value": "password",
      "type": "string"
    },
    {
      "key": "document_id",
      "value": "",
      "type": "string",
      "description": "Document ID (auto-filled after archive)"
    },
    {
      "key": "user_id",
      "value": "",
      "type": "string",
      "description": "User ID"
    }
  ],
  "item": [
    {
      "name": "Health & Status",
      "item": [
        {
          "name": "Root Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/",
              "host": ["{{base_url}}"],
              "path": [""]
            },
            "description": "Get basic health check and application info"
          },
          "response": []
        },
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": ["{{base_url}}"],
              "path": ["health"]
            },
            "description": "Get detailed health check with key statistics"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('access_token', jsonData.access_token);",
                  "    pm.environment.set('refresh_token', jsonData.refresh_token);",
                  "    pm.test('Login successful - tokens set', () => {",
                  "        pm.expect(jsonData).to.have.property('access_token');",
                  "        pm.expect(jsonData).to.have.property('refresh_token');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"{{username}}\",\n  \"password\": \"{{password}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "auth", "login"]
            },
            "description": "Login with username and password to get JWT tokens\n\nDefault credentials:\n- username: admin\n- password: password"
          },
          "response": []
        },
        {
          "name": "Refresh Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refresh_token\": \"{{refresh_token}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/auth/refresh",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "auth", "refresh"]
            },
            "description": "Get a new access token using the refresh token"
          },
          "response": []
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/auth/logout",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "auth", "logout"]
            },
            "description": "Logout and invalidate tokens"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Document Operations",
      "item": [
        {
          "name": "Archive Document",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('document_id', jsonData.document_id);",
                  "    pm.test('Document archived - ID set', () => {",
                  "        pm.expect(jsonData).to.have.property('document_id');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"document_base64\": \"SGVsbG8gV29ybGQhIFRoaXMgaXMgYSB0ZXN0IGRvY3VtZW50Lg==\",\n  \"filename\": \"sample_report.pdf\",\n  \"content_type\": \"application/pdf\",\n  \"tags\": {\n    \"department\": \"finance\",\n    \"year\": \"2026\",\n    \"category\": \"quarterly-report\"\n  },\n  \"metadata\": {\n    \"author\": \"John Doe\",\n    \"version\": \"1.0\",\n    \"confidential\": true\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/archive",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "archive"]
            },
            "description": "Archive a new document with tags and metadata\n\nRequires: document_upload permission"
          },
          "response": []
        },
        {
          "name": "Retrieve Document",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"document_id\": \"{{document_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/retrieve",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "retrieve"]
            },
            "description": "Retrieve a document\n\nRequires: document_download permission"
          },
          "response": []
        },
        {
          "name": "Delete Document",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/archive/{{document_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "archive", "{{document_id}}"]
            },
            "description": "Delete a document from archive\n\nRequires: document_delete permission"
          },
          "response": []
        },
        {
          "name": "Retrieve Document by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/retrieve/{{document_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "retrieve", "{{document_id}}"]
            },
            "description": "Retrieve a document by ID (GET method)"
          },
          "response": []
        },
        {
          "name": "Generate Report",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"start_date\": \"2026-02-01T00:00:00\",\n  \"end_date\": \"2026-02-28T23:59:59\",\n  \"group_by\": \"department\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/report",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "report"]
            },
            "description": "Generate metrics report for archived documents within a time period"
          },
          "response": []
        },
        {
          "name": "Vector Search",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"financial report\",\n  \"top_k\": 5,\n  \"min_similarity\": 0.0\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/search",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "search"]
            },
            "description": "Perform semantic/vector search on documents"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Audit & Compliance",
      "item": [
        {
          "name": "Get Audit Logs",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/audit/logs?start_date=2026-02-01T00:00:00&end_date=2026-02-28T23:59:59&limit=50",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "audit", "logs"],
              "query": [
                {
                  "key": "start_date",
                  "value": "2026-02-01T00:00:00",
                  "description": "ISO format start date (YYYY-MM-DDTHH:MM:SS)"
                },
                {
                  "key": "end_date",
                  "value": "2026-02-28T23:59:59",
                  "description": "ISO format end date (YYYY-MM-DDTHH:MM:SS)"
                },
                {
                  "key": "event_type",
                  "value": "document_upload",
                  "disabled": true,
                  "description": "Filter by event type (login, logout, document_upload, document_delete, user_create, etc.)"
                },
                {
                  "key": "user_id",
                  "value": "1",
                  "disabled": true,
                  "description": "Filter by user ID"
                },
                {
                  "key": "resource_type",
                  "value": "document",
                  "disabled": true,
                  "description": "Filter by resource type (document, user, audit_log, etc.)"
                },
                {
                  "key": "status",
                  "value": "success",
                  "disabled": true,
                  "description": "Filter by status (success, failure, partial)"
                },
                {
                  "key": "skip",
                  "value": "0",
                  "disabled": true,
                  "description": "Pagination offset"
                },
                {
                  "key": "limit",
                  "value": "50",
                  "disabled": true,
                  "description": "Records per page (max 1000)"
                }
              ]
            },
            "description": "Retrieve audit logs for a given period with optional filters\n\nRequires: audit_read permission"
          },
          "response": []
        },
        {
          "name": "Get Audit Logs by Event Type",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/audit/logs?start_date=2026-02-21T00:00:00&end_date=2026-02-21T23:59:59&event_type=document_upload&limit=20",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "audit", "logs"],
              "query": [
                {
                  "key": "start_date",
                  "value": "2026-02-21T00:00:00"
                },
                {
                  "key": "end_date",
                  "value": "2026-02-21T23:59:59"
                },
                {
                  "key": "event_type",
                  "value": "document_upload"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            },
            "description": "Get audit logs filtered by event type"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Deep Archive & Restore",
      "item": [
        {
          "name": "Move to Deep Archive",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"document_id\": \"{{document_id}}\",\n  \"storage_tier\": \"deep_archive\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/deep-archive",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "deep-archive"]
            },
            "description": "Move document to deep archive (AWS Glacier, Azure Archive, GCP Archive)"
          },
          "response": []
        },
        {
          "name": "Restore from Deep Archive",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"document_id\": \"{{document_id}}\",\n  \"restore_days\": 7,\n  \"restore_tier\": \"Standard\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/restore",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "restore"]
            },
            "description": "Restore document from deep archive storage. Note: retrieval may take hours."
          },
          "response": []
        },
        {
          "name": "Get Archive Status",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/archive-status/{{document_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "archive-status", "{{document_id}}"]
            },
            "description": "Get the current archive/restore status of a document"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Glacier & Lifecycle",
      "item": [
        {
          "name": "Retrieve from Glacier",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"document_id\": \"{{document_id}}\",\n  \"restore_tier\": \"Standard\",\n  \"restore_days\": 7\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/glacier/retrieve",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "glacier", "retrieve"]
            },
            "description": "Retrieve a document from Glacier/archive storage. If restored, returns content. Otherwise initiates restore."
          },
          "response": []
        },
        {
          "name": "Retrieve from Glacier by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/glacier/retrieve/{{document_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "glacier", "retrieve", "{{document_id}}"]
            },
            "description": "Retrieve a document from Glacier by ID with default restore options"
          },
          "response": []
        },
        {
          "name": "Run Lifecycle Archival",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"target_tier\": \"deep_archive\",\n  \"dry_run\": false,\n  \"archive_after_days\": 90\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/lifecycle/archive",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "lifecycle", "archive"]
            },
            "description": "Run lifecycle archival process to move old documents to archive storage"
          },
          "response": []
        },
        {
          "name": "Check Restore Status",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/lifecycle/check-restores",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "lifecycle", "check-restores"]
            },
            "description": "Check status of all documents with restore in progress and publish Kafka events for completed restores"
          },
          "response": []
        },
        {
          "name": "Get Documents Eligible for Archival",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/lifecycle/eligible?target_tier=deep_archive&archive_after_days=90",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "lifecycle", "eligible"],
              "query": [
                {
                  "key": "target_tier",
                  "value": "deep_archive"
                },
                {
                  "key": "archive_after_days",
                  "value": "90",
                  "disabled": true
                }
              ]
            },
            "description": "Get documents eligible for archival based on their creation date"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Privacy & Compliance",
      "item": [
        {
          "name": "Detect PII",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"document_id\": \"{{document_id}}\",\n  \"pii_types\": [\"email\", \"phone\", \"ssn\"]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/detect-pii",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "detect-pii"]
            },
            "description": "Scan a document for Personally Identifiable Information\n\nDetects: emails, phone numbers, SSNs, credit cards, IP addresses, names"
          },
          "response": []
        },
        {
          "name": "Anonymize Document",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"document_id\": \"{{document_id}}\",\n  \"pii_types\": [\"email\", \"phone\", \"ssn\"]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/anonymize",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "anonymize"]
            },
            "description": "Anonymize PII in document (redact or remove sensitive information)"
          },
          "response": []
        }
      ]
    }
  ]
}
